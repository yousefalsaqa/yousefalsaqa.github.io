<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Energy Digital Twin | Yousef Alsaqa</title>
  <meta name="description" content="Case study: Building simulation platform integrating EnergyPlus with real-time ML predictions for industrial energy optimization.">
  <meta name="theme-color" content="#050508">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Instrument+Sans:wght@400;500;600;700&family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

  <!-- Bootstrap Icons -->
  <link href="vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">

  <!-- Stylesheets -->
  <link href="css/theme.css" rel="stylesheet">
  <link href="css/pages/case-study.css" rel="stylesheet">
</head>

<body>
  <!-- Header -->
  <header class="header" id="header">
    <div class="header-inner">
      <a href="index.html" class="header-logo">Yousef<span>.</span></a>
      <nav class="header-nav" id="nav">
        <a href="index.html" class="nav-link">Home</a>
        <a href="projects.html" class="nav-link">Projects</a>
        <a href="experience.html" class="nav-link">Experience</a>
        <a href="mailto:21ymsa@queensu.ca" class="nav-link">Contact</a>
      </nav>
      <button class="nav-toggle" id="navToggle" aria-label="Toggle navigation">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </header>

  <main>
    <!-- Hero -->
    <section class="case-hero">
      <div class="container">
        <a href="projects.html" class="back-link">
          <i class="bi bi-arrow-left"></i>
          Back to projects
        </a>
        <h1>Energy Digital Twin</h1>
        <p class="subtitle">A building simulation platform combining EnergyPlus physics modeling with machine learning predictions. Run what-if scenarios and optimize HVAC setpoints without touching real buildings.</p>
        
        <div class="case-meta">
          <div class="case-meta-item">
            <span class="case-meta-label">Role</span>
            <span class="case-meta-value">Full Stack Developer</span>
          </div>
          <div class="case-meta-item">
            <span class="case-meta-label">Timeline</span>
            <span class="case-meta-value">Feb 2025</span> <!-- [VERIFY DATE] -->
          </div>
          <div class="case-meta-item">
            <span class="case-meta-label">Stack</span>
            <span class="case-meta-value">FastAPI, Streamlit, EnergyPlus</span>
          </div>
          <div class="case-meta-item">
            <span class="case-meta-label">Type</span>
            <span class="case-meta-value">Research Project</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Content -->
    <section class="section">
      <div class="container case-content">
        
        <div class="case-section">
          <h2>The Concept</h2>
          <p>A "digital twin" is a virtual replica of a physical system. For buildings, this means a simulation that mirrors how the real building consumes energy based on weather, occupancy, and HVAC settings.</p>
          <p>The value proposition:</p>
          <ul>
            <li><strong>Test changes safely:</strong> "What if we lower the heating setpoint by 2°C?" — answer without freezing employees</li>
            <li><strong>Predict costs:</strong> Forecast next month's energy bill based on weather forecasts</li>
            <li><strong>Optimize operations:</strong> Find the sweet spot between comfort and efficiency</li>
          </ul>
        </div>

        <div class="case-section">
          <h2>Architecture</h2>
          <p>The system has three main components:</p>

          <div class="case-code">
<pre>
digital_twin_app/
├── backend/
│   ├── main.py                   # FastAPI endpoints
│   ├── simulation.py             # Lightweight baseline model
│   ├── prediction.py             # ML forecasting
│   └── energyplus_integration.py # EnergyPlus interface
├── frontend/
│   └── dashboard.py              # Streamlit visualization
├── requirements.txt
└── README.md
</pre>
          </div>

          <h3>Two Simulation Modes</h3>
          <p><strong>Lightweight mode:</strong> A simple baseline + volatility model for quick what-if scenarios. Runs instantly, good for exploring the parameter space.</p>
          <p><strong>Physics mode:</strong> Full EnergyPlus simulation using the building's IDF (Input Data File). Takes minutes but gives accurate thermal behavior including zone interactions, solar gains, and HVAC dynamics.</p>
        </div>

        <div class="case-section">
          <h2>EnergyPlus Integration</h2>
          <p>EnergyPlus is the gold standard for building energy simulation, developed by the U.S. Department of Energy. Integrating it required:</p>
          
          <div class="tech-grid">
            <div class="tech-item">
              <h4>Eppy Library</h4>
              <p>Python interface for reading and modifying IDF files</p>
            </div>
            <div class="tech-item">
              <h4>Subprocess Management</h4>
              <p>Running EnergyPlus as a background process with proper I/O handling</p>
            </div>
            <div class="tech-item">
              <h4>Weather Files</h4>
              <p>EPW format weather data for accurate environmental conditions</p>
            </div>
            <div class="tech-item">
              <h4>Output Parsing</h4>
              <p>CSV result parsing with unit conversion and aggregation</p>
            </div>
          </div>

          <div class="case-code">
<pre>
def run_energyplus_simulation(setpoint_heating, setpoint_cooling):
    """Run EnergyPlus with modified thermostat setpoints."""
    
    # Load and modify IDF
    idf = IDF(idf_template)
    for thermostat in idf.idfobjects.get("ThermostatSetpoint:DualSetpoint", []):
        thermostat.Heating_Setpoint_Temperature = setpoint_heating
        thermostat.Cooling_Setpoint_Temperature = setpoint_cooling
    
    modified_idf = "modified_building.idf"
    idf.saveas(modified_idf)
    
    # Run simulation
    command = [
        energyplus_path,
        "-w", weather_file,
        "-d", output_dir,
        modified_idf
    ]
    result = subprocess.run(command, capture_output=True, text=True)
    
    # Parse results
    if os.path.exists(f"{output_dir}/eplusout.csv"):
        return pd.read_csv(f"{output_dir}/eplusout.csv")
    return None
</pre>
          </div>
        </div>

        <div class="case-section">
          <h2>Machine Learning Layer</h2>
          <p>EnergyPlus is accurate but slow. For real-time predictions, we train ML models on EnergyPlus output:</p>

          <h3>Training Pipeline</h3>
          <ol>
            <li>Run hundreds of EnergyPlus simulations with varied parameters</li>
            <li>Extract features: outdoor temp, time of day, setpoints, occupancy</li>
            <li>Train regression models on energy consumption</li>
            <li>Deploy models for instant predictions</li>
          </ol>

          <div class="case-code">
<pre>
def train_predictive_model(simulation_data):
    """Train linear regression on simulation results."""
    X = simulation_data[['Time', 'OutdoorTemp', 'Setpoint', 'Occupancy']]
    y = simulation_data['Energy']
    
    X_train, X_test, y_train, y_test = train_test_split(
        X, y, test_size=0.2, random_state=42
    )
    
    model = LinearRegression()
    model.fit(X_train, y_train)
    
    y_pred = model.predict(X_test)
    mse = mean_squared_error(y_test, y_pred)
    
    return model, mse
</pre>
          </div>

          <p>The ML model serves as a "surrogate" — fast approximation when you don't need physics-level accuracy.</p>
        </div>

        <div class="case-section">
          <h2>API Design</h2>
          <p>The FastAPI backend exposes clean REST endpoints:</p>

          <div class="case-code">
<pre>
# Simulation endpoint
@app.post("/simulate")
def run_simulation(request: SimulationRequest) -> SimulationResponse:
    """Run lightweight energy simulation."""
    data = simulate_energy(
        baseline=request.baseline,
        volatility=request.volatility,
        time_steps=request.time_steps
    )
    return SimulationResponse(
        time=data['Time'].tolist(),
        energy=data['Energy'].tolist()
    )

# Training endpoint
@app.post("/train")
def train_model() -> TrainResponse:
    """Train ML model on current simulation data."""
    model, mse = train_predictive_model(simulation_data)
    return TrainResponse(mse=mse, status="trained")

# Prediction endpoint
@app.post("/predict")
def predict(request: PredictRequest) -> PredictResponse:
    """Predict energy consumption for future timesteps."""
    predictions = model.predict(request.future_times)
    return PredictResponse(predictions=predictions.tolist())
</pre>
          </div>
        </div>

        <div class="case-section">
          <h2>Frontend Dashboard</h2>
          <p>Streamlit provides an interactive interface for non-technical users:</p>
          <ul>
            <li><strong>Parameter sliders:</strong> Adjust setpoints and see predicted impact</li>
            <li><strong>Time series charts:</strong> Visualize energy consumption patterns</li>
            <li><strong>Comparison mode:</strong> Overlay baseline vs. modified scenarios</li>
            <li><strong>Export:</strong> Download simulation results as CSV</li>
          </ul>
        </div>

        <div class="case-section">
          <h2>Technical Stack</h2>
          
          <div class="results-grid">
            <div class="result-item">
              <span class="result-number">FastAPI</span>
              <span class="result-label">Backend framework</span>
            </div>
            <div class="result-item">
              <span class="result-number">Streamlit</span>
              <span class="result-label">Frontend dashboard</span>
            </div>
            <div class="result-item">
              <span class="result-number">EnergyPlus</span>
              <span class="result-label">Physics simulation</span>
            </div>
            <div class="result-item">
              <span class="result-number">scikit-learn</span>
              <span class="result-label">ML predictions</span>
            </div>
          </div>
        </div>

        <div class="case-section">
          <h2>Deployment</h2>
          <p>The application runs as three services:</p>

          <div class="case-code">
<pre>
# 1. Start backend API
cd backend
uvicorn main:app --reload --port 8000

# 2. Launch frontend
cd frontend
streamlit run dashboard.py --server.port 8501

# 3. EnergyPlus runs on-demand via subprocess
# (Requires EnergyPlus installation and IDF template)
</pre>
          </div>
        </div>

        <div class="case-section">
          <h2>What I Learned</h2>
          <ul>
            <li><strong>Domain integration is tricky.</strong> EnergyPlus has decades of legacy and its own ecosystem. Learning to work with IDF files and EPW weather data took significant effort.</li>
            <li><strong>Surrogate models are powerful.</strong> Physics simulations are accurate but slow. ML approximations enable interactive exploration that wouldn't be possible otherwise.</li>
            <li><strong>Streamlit is great for prototypes.</strong> Building a functional dashboard in hours instead of days let us focus on the simulation logic.</li>
          </ul>
        </div>

        <nav class="case-nav">
          <a href="qsetarm-details.html">
            <i class="bi bi-arrow-left"></i>
            QSET Robotic Arm
          </a>
          <a href="projects.html">
            All Projects
            <i class="bi bi-arrow-right"></i>
          </a>
        </nav>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-main">
          <h2>Let's talk.</h2>
          <p>I'm looking for full-time opportunities in robotics, automation, or anywhere I can build things that matter.</p>
          <a href="mailto:21ymsa@queensu.ca" class="footer-email">
            <i class="bi bi-envelope"></i>
            21ymsa@queensu.ca
          </a>
        </div>
        <div class="footer-links">
          <a href="https://www.linkedin.com/in/yousef-alsaqa-b1ab4822b/" target="_blank">
            <i class="bi bi-linkedin"></i>
            LinkedIn
          </a>
          <a href="https://github.com/yousefalsaqa" target="_blank">
            <i class="bi bi-github"></i>
            GitHub
          </a>
          <a href="assets/Yousef_Alsaqa_Resume.pdf" target="_blank">
            <i class="bi bi-file-earmark-text"></i>
            Resume
          </a>
        </div>
      </div>
      <div class="footer-bottom">
        <p>© 2025 Yousef Alsaqa</p>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script>
    const navToggle = document.getElementById('navToggle');
    const nav = document.getElementById('nav');
    
    navToggle.addEventListener('click', () => {
      nav.classList.toggle('active');
      navToggle.classList.toggle('active');
    });

    const header = document.getElementById('header');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 50) {
        header.classList.add('scrolled');
      } else {
        header.classList.remove('scrolled');
      }
    });
  </script>
</body>
</html>
